<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="testing utilities for trillium applications."><title>trillium_testing - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-deb46770fd761b69.css"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="trillium_testing" data-themes="" data-resource-suffix="" data-rustdoc-version="1.75.0-nightly (1c05d50c8 2023-10-21)" data-channel="nightly" data-search-js="search-8fbf244ebcf71464.js" data-settings-js="settings-74424d7eec62a23e.js" ><script src="../static.files/storage-fec3eaa3851e447d.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-5f34af1a0ee6bacd.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-5d8b3c7633ad77ba.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../trillium_testing/index.html">trillium_testing</a><span class="version">0.5.0</span></h2></div><div class="sidebar-elems"><ul class="block">
            <li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#reexports">Re-exports</a></li><li><a href="#modules">Modules</a></li><li><a href="#macros">Macros</a></li><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#traits">Traits</a></li><li><a href="#functions">Functions</a></li><li><a href="#types">Type Aliases</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Crate <a class="mod" href="#">trillium_testing</a><button id="copy-path" title="Copy item path to clipboard"><img src="../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="src" href="../src/trillium_testing/lib.rs.html#1-185">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>testing utilities for trillium applications.</p>
<p>this crate is intended to be used as a development dependency.</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>trillium_testing::prelude::<span class="kw-2">*</span>;
<span class="kw">use </span>trillium::{Conn, conn_try};
<span class="kw">async fn </span>handler(<span class="kw-2">mut </span>conn: Conn) -&gt; Conn {
    <span class="kw">let </span>request_body = <span class="macro">conn_try!</span>(conn.request_body_string().<span class="kw">await</span>, conn);
    conn.with_body(<span class="macro">format!</span>(<span class="string">&quot;request body was: {}&quot;</span>, request_body))
        .with_status(<span class="number">418</span>)
        .with_header(<span class="string">&quot;request-id&quot;</span>, <span class="string">&quot;special-request&quot;</span>)
}

<span class="macro">assert_response!</span>(
    post(<span class="string">&quot;/&quot;</span>).with_request_body(<span class="string">&quot;hello trillium!&quot;</span>).on(<span class="kw-2">&amp;</span>handler),
    Status::ImATeapot,
    <span class="string">&quot;request body was: hello trillium!&quot;</span>,
    <span class="string">&quot;request-id&quot; </span>=&gt; <span class="string">&quot;special-request&quot;</span>,
    <span class="string">&quot;content-length&quot; </span>=&gt; <span class="string">&quot;33&quot;
</span>);
</code></pre></div>
<h3 id="features"><a href="#features">Features</a></h3>
<p><strong>You must enable a runtime feature for trillium testing</strong></p>
<h4 id="tokio"><a href="#tokio">Tokio:</a></h4><div class="example-wrap"><pre class="language-toml"><code>[dev-dependencies]
# ...
trillium-testing = { version = &quot;0.2&quot;, features = [&quot;tokio&quot;] }
</code></pre></div><h4 id="async-std"><a href="#async-std">Async-std:</a></h4><div class="example-wrap"><pre class="language-toml"><code>[dev-dependencies]
# ...
trillium-testing = { version = &quot;0.2&quot;, features = [&quot;async-std&quot;] }
</code></pre></div><h4 id="smol"><a href="#smol">Smol:</a></h4><div class="example-wrap"><pre class="language-toml"><code>[dev-dependencies]
# ...
trillium-testing = { version = &quot;0.2&quot;, features = [&quot;smol&quot;] }
</code></pre></div></div></details><h2 id="reexports" class="small-section-header"><a href="#reexports">Re-exports</a></h2><ul class="item-table"><li><div class="item-name" id="reexport.futures_lite"><code>pub use futures_lite;</code></div></li></ul><h2 id="modules" class="small-section-header"><a href="#modules">Modules</a></h2><ul class="item-table"><li><div class="item-name"><a class="mod" href="methods/index.html" title="mod trillium_testing::methods">methods</a></div><div class="desc docblock-short"><a href="struct.TestConn.html" title="struct trillium_testing::TestConn"><code>TestConn</code></a> builders for http methods</div></li><li><div class="item-name"><a class="mod" href="prelude/index.html" title="mod trillium_testing::prelude">prelude</a></div><div class="desc docblock-short">useful stuff for testing trillium apps</div></li></ul><h2 id="macros" class="small-section-header"><a href="#macros">Macros</a></h2><ul class="item-table"><li><div class="item-name"><a class="macro" href="macro.assert_body.html" title="macro trillium_testing::assert_body">assert_body</a></div><div class="desc docblock-short">assert that the response body is as specified. this assertion requires mutation of the conn.</div></li><li><div class="item-name"><a class="macro" href="macro.assert_body_contains.html" title="macro trillium_testing::assert_body_contains">assert_body_contains</a></div><div class="desc docblock-short">asserts that the response body matches the specified pattern, using <a href="https://doc.rust-lang.org/nightly/std/primitive.str.html#method.contains" title="method str::contains"><code>str::contains</code></a></div></li><li><div class="item-name"><a class="macro" href="macro.assert_headers.html" title="macro trillium_testing::assert_headers">assert_headers</a></div><div class="desc docblock-short">asserts any number of response headers</div></li><li><div class="item-name"><a class="macro" href="macro.assert_not_handled.html" title="macro trillium_testing::assert_not_handled">assert_not_handled</a></div><div class="desc docblock-short">assert that all of the following are true:</div></li><li><div class="item-name"><a class="macro" href="macro.assert_ok.html" title="macro trillium_testing::assert_ok">assert_ok</a></div><div class="desc docblock-short">assert_ok is like <a href="prelude/macro.assert_response.html" title="macro trillium_testing::prelude::assert_response"><code>assert_response!</code></a> except it always asserts a status of 200 Ok.</div></li><li><div class="item-name"><a class="macro" href="macro.assert_response.html" title="macro trillium_testing::assert_response">assert_response</a></div><div class="desc docblock-short">combines several other assertions. this assertion can be used to assert:</div></li><li><div class="item-name"><a class="macro" href="macro.assert_status.html" title="macro trillium_testing::assert_status">assert_status</a></div><div class="desc docblock-short">assert that the status code of a conn is as specified.</div></li></ul><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.ClientConfig.html" title="struct trillium_testing::ClientConfig">ClientConfig</a></div><div class="desc docblock-short">configuration for the tcp Connector</div></li><li><div class="item-name"><a class="struct" href="struct.RuntimelessClientConfig.html" title="struct trillium_testing::RuntimelessClientConfig">RuntimelessClientConfig</a></div><div class="desc docblock-short">An in-memory Connector to use with GenericServer.</div></li><li><div class="item-name"><a class="struct" href="struct.RuntimelessServer.html" title="struct trillium_testing::RuntimelessServer">RuntimelessServer</a></div><div class="desc docblock-short">A [<code>Server</code>] for testing that does not depend on any runtime</div></li><li><div class="item-name"><a class="struct" href="struct.ServerConnector.html" title="struct trillium_testing::ServerConnector">ServerConnector</a></div><div class="desc docblock-short">a bridge between trillium servers and clients</div></li><li><div class="item-name"><a class="struct" href="struct.TestConn.html" title="struct trillium_testing::TestConn">TestConn</a></div><div class="desc docblock-short">A wrapper around a <a href="prelude/struct.Conn.html" title="struct trillium_testing::prelude::Conn"><code>trillium::Conn</code></a> for testing</div></li><li><div class="item-name"><a class="struct" href="struct.TestTransport.html" title="struct trillium_testing::TestTransport">TestTransport</a></div><div class="desc docblock-short">a readable and writable transport for testing</div></li><li><div class="item-name"><a class="struct" href="struct.Url.html" title="struct trillium_testing::Url">Url</a></div><div class="desc docblock-short">A parsed URL record.</div></li></ul><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2><ul class="item-table"><li><div class="item-name"><a class="enum" href="enum.Method.html" title="enum trillium_testing::Method">Method</a></div><div class="desc docblock-short">HTTP request methods.</div></li><li><div class="item-name"><a class="enum" href="enum.Status.html" title="enum trillium_testing::Status">Status</a></div><div class="desc docblock-short">HTTP response status codes.</div></li></ul><h2 id="traits" class="small-section-header"><a href="#traits">Traits</a></h2><ul class="item-table"><li><div class="item-name"><a class="trait" href="trait.AsyncRead.html" title="trait trillium_testing::AsyncRead">AsyncRead</a></div><div class="desc docblock-short">Read bytes asynchronously.</div></li><li><div class="item-name"><a class="trait" href="trait.AsyncReadExt.html" title="trait trillium_testing::AsyncReadExt">AsyncReadExt</a></div><div class="desc docblock-short">Extension trait for <a href="trait.AsyncRead.html" title="trait trillium_testing::AsyncRead"><code>AsyncRead</code></a>.</div></li><li><div class="item-name"><a class="trait" href="trait.AsyncWrite.html" title="trait trillium_testing::AsyncWrite">AsyncWrite</a></div><div class="desc docblock-short">Write bytes asynchronously.</div></li></ul><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.block_on.html" title="fn trillium_testing::block_on">block_on</a></div><div class="desc docblock-short">Runs the global and the local executor on the current thread</div></li><li><div class="item-name"><a class="fn" href="fn.client_config.html" title="fn trillium_testing::client_config">client_config</a></div><div class="desc docblock-short">runtime client config</div></li><li><div class="item-name"><a class="fn" href="fn.config.html" title="fn trillium_testing::config">config</a></div><div class="desc docblock-short">runtime server config</div></li><li><div class="item-name"><a class="fn" href="fn.connector.html" title="fn trillium_testing::connector">connector</a></div><div class="desc docblock-short">build a connector from this handler</div></li><li><div class="item-name"><a class="fn" href="fn.harness.html" title="fn trillium_testing::harness">harness</a></div><div class="desc docblock-short">a test harness for use with [<code>test_harness</code>]</div></li><li><div class="item-name"><a class="fn" href="fn.init.html" title="fn trillium_testing::init">init</a></div><div class="desc docblock-short">initialize a handler</div></li><li><div class="item-name"><a class="fn" href="fn.spawn.html" title="fn trillium_testing::spawn">spawn</a></div><div class="desc docblock-short">spawn and detach a Future that returns ()</div></li><li><div class="item-name"><a class="fn" href="fn.with_server.html" title="fn trillium_testing::with_server">with_server</a></div><div class="desc docblock-short">Starts a trillium handler bound to a random available port on
localhost, run the async tests provided as the second
argument, and then shut down the server. useful for full
integration tests that actually exercise the tcp layer.</div></li><li><div class="item-name"><a class="fn" href="fn.with_transport.html" title="fn trillium_testing::with_transport">with_transport</a></div><div class="desc docblock-short">open an in-memory connection to this handler and call an async
function with an open BoxedTransport</div></li></ul><h2 id="types" class="small-section-header"><a href="#types">Type Aliases</a></h2><ul class="item-table"><li><div class="item-name"><a class="type" href="type.TestResult.html" title="type trillium_testing::TestResult">TestResult</a></div><div class="desc docblock-short">a sponge Result</div></li></ul></section></div></main></body></html>